import os\nimport shutil\nimport zipfile\n\n\ndef clean_and_zip(source_folder, output_zip):\n    # Create necessary directories\n    os.makedirs('assets/css', exist_ok=True)\n    os.makedirs('assets/js', exist_ok=True)\n    os.makedirs('assets/data', exist_ok=True)\n\n    # Function to remove spaces from folder names\n    def remove_spaces(path):\n        for root, dirs, files in os.walk(path):\n            for dir_name in dirs:\n                new_dir_name = dir_name.replace(' ', '_')\n                os.rename(os.path.join(root, dir_name), os.path.join(root, new_dir_name))\n\n    # Remove spaces from the folder structure\n    remove_spaces(source_folder)\n\n    # Move files to their respective folders and remove duplicates\n    seen_files = set()\n    for root, dirs, files in os.walk(source_folder):\n        for file in files:\n            file_path = os.path.join(root, file)\n            file_extension = os.path.splitext(file)[1].lower()\n\n            if file_path in seen_files:\n                continue\n            seen_files.add(file_path)\n\n            if file_extension == '.css':\n                shutil.move(file_path, 'assets/css/')\n            elif file_extension == '.js':\n                shutil.move(file_path, 'assets/js/')\n            elif file_extension in ['.json', '.csv', '.txt']:  # data files\n                shutil.move(file_path, 'assets/data/')\n\n    # Create a new ZIP file with the cleaned files\n    with zipfile.ZipFile(output_zip, 'w') as zip_file:\n        for folder_name, subfolders, filenames in os.walk('assets'):\n            for filename in filenames:\n                file_path = os.path.join(folder_name, filename)\n                zip_file.write(file_path, os.path.relpath(file_path, 'assets'))\n\nif __name__ == '__main__':\n    clean_and_zip('.', 'NeoGadgetHubPro_FIXED.zip')\n